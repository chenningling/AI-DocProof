# AI文档校对工具 (AI-DocProof 1.0)

## 项目简介
AI文档校对工具是一个用于自动检查Word文档中错别字的应用程序。它通过基础标点规则将文档分割成短句，然后利用AI API进行错别字检查，并在原文档中添加批注指出错误。本工具适用于需要高效校对文档的场景，如论文、报告、文章等文本内容的校对。

## 功能特点
- 支持上传Word文档并进行错别字校对
- 自动分句处理，以句号、问号、感叹号为分隔符，智能识别特殊情况
- 调用DeepSeek API进行错别字检查，支持自定义API参数
- 自动在文档中添加批注标记错误，直观显示修改建议
- 生成详细校对日志，可导出为txt文件
- 支持校对进度实时显示和中断恢复
- 支持Windows和Mac操作系统
- 内置错误重试机制，提高校对稳定性

## 使用方法
1. 运行程序，打开主界面
2. 点击“选择文档”按钮，选择需要校对的Word文档
3. 点击“模型配置”按钮，设置API相关参数
4. 点击“开始校对”按钮，开始校对过程
5. 校对完成后，可以点击“导出记录”保存校对日志
6. 校对后的文档会自动保存在原文档同目录下，文件名后缀为“_AI校对”

## 系统要求
- Python 3.6+
- Windows 10/11 或 macOS 10.14+
- 网络连接（用于API调用）
- DeepSeek API密钥（或其他兼容的大语言模型API）

## 安装步骤

### 1. 克隆或下载项目
```bash
git clone https://github.com/yourusername/AI-DocProof1.0.git
cd AI-DocProof1.0
```

### 2. 创建虚拟环境（推荐）
```bash
python -m venv venv

# Windows激活虚拟环境
venv\Scripts\activate

# macOS/Linux激活虚拟环境
source venv/bin/activate
```

### 3. 安装依赖
```bash
pip install -r requirements.txt
```

## 运行程序
```bash
python src/main.py
```

## API配置说明
程序默认使用DeepSeek API进行错别字检查，您需要设置以下参数：

- **API URL**: API服务器地址，默认为`https://api.deepseek.com/chat/completions`
- **模型名称**: 使用的模型名称，默认为`deepseek-chat`
- **API密钥**: 您的DeepSeek API密钥，必须填写
- **系统提示词**: 可以根据需要自定义，默认已优化为错别字检查场景

配置信息会保存在项目根目录的`config.json`文件中。

## 技术架构

### 核心模块
- **文档处理模块** (`doc_processor.py`): 负责Word文档的读取、分句和批注
- **API客户端模块** (`api_client.py`): 负责与AI API的通信，发送请求并处理响应
- **日志管理模块** (`log_manager.py`): 负责记录和导出校对日志
- **配置管理模块** (`config_manager.py`): 负责管理API配置信息的保存和读取
- **图形界面模块** (`gui/main_window.py`): 负责主界面的展示和交互

### 工作流程
1. 用户上传Word文档
2. 系统将文档分割成句子
3. 系统逐句调用API进行错别字检查
4. 对于检测到错误的句子，在原文档中添加批注
5. 生成校对日志，可导出为txt文件
6. 保存修改后的文档

## 常见问题及解决方案

### API调用超时问题
**问题**: 在校对过程中出现API调用超时错误  
**解决方案**: 
- 检查网络连接是否稳定
- 程序已内置重试机制，会自动尝试重新连接
- 如持续出现问题，可以尝试减小文档大小或分批处理

### 文档格式问题
**问题**: 某些特殊格式的Word文档无法正确处理  
**解决方案**:
- 确保文档为.docx格式（不支持.doc格式）
- 尝试将文档另存为新的.docx文件后再处理
- 避免使用过于复杂的格式和嵌入对象

### 分句不准确问题
**问题**: 文档分句不够准确，影响校对效果  
**解决方案**:
- 程序已内置多种特殊情况的处理规则
- 可以在文档中使用明确的标点符号
- 后续版本将持续优化分句算法

## 许可证
本项目采用 MIT 许可证。

